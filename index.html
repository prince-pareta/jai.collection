<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JAI COLLECTION | Luxury Fashion</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,700;1,400&family=Inter:wght@300;400;500&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --bg: #FFFFFF;
            --text: #0a0a0a;
            --accent: #CFA15D; /* Gold finish for luxury */
            --gray: #F5F5F5;
        }
        
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Inter', sans-serif; background: var(--bg); color: var(--text); overflow-x: hidden; }
        h1, h2, h3 { font-family: 'Playfair Display', serif; }
        
        /* --- HEADER --- */
        header { position: sticky; top: 0; background: rgba(255,255,255,0.95); backdrop-filter: blur(10px); z-index: 1000; padding: 20px 40px; display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid rgba(0,0,0,0.05); }
        .logo { font-size: 28px; font-weight: 700; letter-spacing: -1px; text-transform: uppercase; }
        .nav-links { display: flex; gap: 30px; }
        .nav-link { cursor: pointer; text-transform: uppercase; font-size: 12px; letter-spacing: 1px; font-weight: 500; transition: 0.3s; }
        .nav-link:hover, .nav-link.active { border-bottom: 1px solid black; }
        
        /* --- HERO SECTION --- */
        .hero { height: 80vh; background: #000; color: white; display: flex; flex-direction: column; justify-content: center; align-items: center; text-align: center; position: relative; overflow: hidden; }
        .hero img { position: absolute; inset: 0; width: 100%; height: 100%; object-fit: cover; opacity: 0.6; }
        .hero-content { position: relative; z-index: 2; animation: fadeIn 1.5s ease; }
        .hero h1 { font-size: 4rem; margin-bottom: 20px; font-style: italic; }
        .btn-shop { padding: 15px 40px; background: white; color: black; border: none; font-size: 14px; text-transform: uppercase; letter-spacing: 2px; cursor: pointer; transition: 0.3s; font-weight: 600; }
        .btn-shop:hover { background: var(--accent); color: white; }

        /* --- PRODUCT GRID --- */
        .container { max-width: 1400px; margin: 0 auto; padding: 60px 20px; }
        .section-title { font-size: 2rem; text-align: center; margin-bottom: 40px; font-weight: 400; }
        
        .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 40px; }
        .card { cursor: pointer; group: hover; }
        .card-img { width: 100%; aspect-ratio: 3/4; background: var(--gray); overflow: hidden; position: relative; }
        .card-img img { width: 100%; height: 100%; object-fit: cover; transition: transform 0.6s cubic-bezier(0.25, 0.46, 0.45, 0.94); }
        .card:hover .card-img img { transform: scale(1.05); }
        
        .card-info { padding-top: 15px; text-align: center; }
        .p-cat { font-size: 10px; color: #666; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 5px; }
        .p-name { font-family: 'Playfair Display', serif; font-size: 18px; margin-bottom: 5px; }
        .p-price { font-weight: 500; font-size: 14px; }

        /* --- CART SIDEBAR --- */
        .cart-sidebar { position: fixed; top: 0; right: -400px; width: 400px; height: 100%; background: white; z-index: 2000; padding: 30px; box-shadow: -10px 0 40px rgba(0,0,0,0.1); transition: 0.4s ease; display: flex; flex-direction: column; }
        .cart-sidebar.open { right: 0; }
        .cart-header { display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid #eee; padding-bottom: 20px; margin-bottom: 20px; }
        .cart-items { flex: 1; overflow-y: auto; }
        .checkout-btn { width: 100%; padding: 18px; background: black; color: white; border: none; text-transform: uppercase; letter-spacing: 2px; font-weight: 600; cursor: pointer; margin-top: 20px; }

        /* --- CHECKOUT FORM MODAL --- */
        .modal-overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.5); z-index: 3000; display: none; justify-content: center; align-items: center; backdrop-filter: blur(5px); }
        .checkout-form { background: white; padding: 40px; width: 100%; max-width: 500px; }
        .form-input { width: 100%; padding: 15px; border: 1px solid #ddd; margin-bottom: 15px; outline: none; font-family: 'Inter', sans-serif; }
        .form-input:focus { border-color: black; }

        @media(max-width: 768px) {
            .hero h1 { font-size: 2.5rem; }
            .grid { grid-template-columns: repeat(2, 1fr); gap: 15px; }
            .cart-sidebar { width: 100%; }
        }
    </style>
</head>
<body>

    <header>
        <div class="logo">JAI COLLECTION</div>
        <nav class="nav-links" id="catNav">
            <span class="nav-link active" onclick="filterCat('All', this)">All</span>
            <span class="nav-link" onclick="filterCat('Men', this)">Men</span>
            <span class="nav-link" onclick="filterCat('Women', this)">Women</span>
            <span class="nav-link" onclick="filterCat('Kids', this)">Kids</span>
        </nav>
        <div onclick="toggleCart()" style="cursor:pointer; font-size:14px; text-transform:uppercase;">
            Cart (<span id="cartCount">0</span>)
        </div>
    </header>

    <div class="hero">
        <img src="https://images.unsplash.com/photo-1469334031218-e382a71b716b?w=1600" alt="Luxury Fashion">
        <div class="hero-content">
            <h1>The New Era of<br>Elegance.</h1>
            <button class="btn-shop" onclick="window.scrollTo(0, 800)">Explore Collection</button>
        </div>
    </div>

    <div class="container">
        <h2 class="section-title">Latest Arrivals</h2>
        <div class="grid" id="productGrid">
            <p style="grid-column:1/-1; text-align:center;">Loading Collection...</p>
        </div>
    </div>

    <div class="cart-sidebar" id="cartSidebar">
        <div class="cart-header">
            <h3>Shopping Bag</h3>
            <i class="fas fa-times" onclick="toggleCart()" style="cursor:pointer"></i>
        </div>
        <div class="cart-items" id="cartList"></div>
        <div style="border-top:1px solid #eee; padding-top:20px;">
            <div style="display:flex; justify-content:space-between; margin-bottom:15px; font-weight:600;">
                <span>Total</span>
                <span id="cartTotal">₹0</span>
            </div>
            <button class="checkout-btn" onclick="openCheckout()">Checkout Securely</button>
        </div>
    </div>

    <div class="modal-overlay" id="checkoutModal">
        <div class="checkout-form">
            <h2 style="font-family:'Playfair Display'; margin-bottom:20px;">Secure Checkout</h2>
            <form onsubmit="placeOrder(event)">
                <input type="text" class="form-input" id="cName" placeholder="Full Name" required>
                <input type="tel" class="form-input" id="cPhone" placeholder="Phone Number" required>
                <textarea class="form-input" id="cAddr" rows="3" placeholder="Shipping Address" required></textarea>
                <button type="submit" class="checkout-btn">Confirm Order</button>
                <button type="button" onclick="document.getElementById('checkoutModal').style.display='none'" style="width:100%; padding:15px; background:transparent; border:none; cursor:pointer; margin-top:10px;">Cancel</button>
            </form>
        </div>
    </div>

<script>
    const API = '/.netlify/functions/api';
    let products = [];
    let cart = JSON.parse(localStorage.getItem('jaiCart')) || [];

    // --- INITIAL LOAD ---
    window.onload = () => { fetchProducts('All'); updateCartUI(); };

    async function fetchProducts(cat) {
        try {
            const url = cat === 'All' ? `${API}?path=products` : `${API}?path=products&cat=${cat}`;
            const res = await fetch(url);
            products = await res.json();
            renderGrid(products);
        } catch(e) { console.error(e); }
    }

    function renderGrid(list) {
        const grid = document.getElementById('productGrid');
        grid.innerHTML = "";
        list.forEach(p => {
            const img = p.images ? p.images[0] : 'https://placehold.co/400';
            grid.innerHTML += `
                <div class="card" onclick="addToCart(${p.id})">
                    <div class="card-img"><img src="${img}"></div>
                    <div class="card-info">
                        <div class="p-cat">${p.category}</div>
                        <div class="p-name">${p.name}</div>
                        <div class="p-price">₹${p.price}</div>
                        <button style="margin-top:10px; background:black; color:white; border:none; padding:5px 15px; cursor:pointer;">Add to Bag</button>
                    </div>
                </div>
            `;
        });
    }

    function filterCat(cat, btn) {
        document.querySelectorAll('.nav-link').forEach(l => l.classList.remove('active'));
        btn.classList.add('active');
        fetchProducts(cat);
    }

    // --- CART FUNCTIONS ---
    function addToCart(id) {
        const p = products.find(x => x.id === id);
        cart.push(p);
        localStorage.setItem('jaiCart', JSON.stringify(cart));
        updateCartUI();
        toggleCart();
    }

    function toggleCart() { document.getElementById('cartSidebar').classList.toggle('open'); }
    
    function updateCartUI() {
        document.getElementById('cartCount').innerText = cart.length;
        const list = document.getElementById('cartList');
        list.innerHTML = "";
        let total = 0;
        cart.forEach((item, idx) => {
            total += parseFloat(item.price);
            list.innerHTML += `
                <div style="display:flex; gap:15px; margin-bottom:15px;">
                    <img src="${item.images[0]}" style="width:60px; height:80px; object-fit:cover;">
                    <div>
                        <div style="font-weight:600">${item.name}</div>
                        <div style="font-size:12px; color:#777">₹${item.price}</div>
                        <div style="font-size:10px; text-decoration:underline; cursor:pointer;" onclick="remItem(${idx})">Remove</div>
                    </div>
                </div>
            `;
        });
        document.getElementById('cartTotal').innerText = "₹" + total;
    }
    
    function remItem(i) { cart.splice(i,1); localStorage.setItem('jaiCart', JSON.stringify(cart)); updateCartUI(); }

    // --- CHECKOUT ---
    function openCheckout() {
        if(cart.length === 0) return alert("Bag is empty");
        document.getElementById('checkoutModal').style.display = 'flex';
        document.getElementById('cartSidebar').classList.remove('open');
    }

    async function placeOrder(e) {
        e.preventDefault();
        const btn = e.target.querySelector('button[type="submit"]');
        btn.innerText = "Processing...";
        
        const orderData = {
            customer: {
                name: document.getElementById('cName').value,
                phone: document.getElementById('cPhone').value,
                address: document.getElementById('cAddr').value
            },
            items: JSON.stringify(cart),
            total: document.getElementById('cartTotal').innerText.replace('₹', '')
        };

        await fetch(`${API}?path=orders`, {
            method: 'POST',
            body: JSON.stringify(orderData)
        });

        alert("Order Successful! We will contact you shortly.");
        cart = [];
        localStorage.setItem('jaiCart', JSON.stringify(cart));
        window.location.reload();
    }
</script>
</body>
</html>